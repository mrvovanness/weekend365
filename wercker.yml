box: wercker/rvm
build:
  steps:
    - rvm-use:
        version: 2.2.2

    - bundle-install

    - script:
        name: echo ruby information
        code: |
          echo "ruby version $(ruby --version) running"
          echo "from location $(which ruby)"
          echo -p "gem list: $(gem list)"

    - script:
        name: rspec
        code: bundle exec rspec -r turnip/rspec

    - script:
        name: rubocop
        code: bundle exec rubocop

deploy:
  steps:
    - heroku-deploy:
        install-toolbelt: true
        key-name: heroku

    - script:
        name: Update database
        code: heroku run:detached rake db:migrate --app $APP_NAME
